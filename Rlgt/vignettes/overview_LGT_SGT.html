<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-10-20" />

<title>Overview of the LGT and SGT Models</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Overview of the LGT and SGT Models</h1>
<h4 class="date"><em>2018-10-20</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette will provide an overview of the theoretical construction of the LGT and SGT family models. The “LGT” model stands for Local-Global Trend and is devised to forecast on non-seasonal time series data. Meanwhile, the “SGT” model stands for Seasonal-Global Trend and is devised to complement the former model on seasonal time series data. The combination of these models were tested on the 3003 time-series data available from the M3-competition dataset, and they have been shown to outperform all of the models originally participating in the competition by a significant margin.</p>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th>sMAPE</th>
<th>MASE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dampen-M3</td>
<td>12.3827</td>
<td>2.1778</td>
</tr>
<tr class="even">
<td>Best M3 Model</td>
<td>12.76</td>
<td>1.39</td>
</tr>
<tr class="odd">
<td>Dampen-fpp2</td>
<td>12.3997</td>
<td>1.6346</td>
</tr>
<tr class="even">
<td>LGT&amp;SGT</td>
<td>12.2163</td>
<td>1.3724</td>
</tr>
</tbody>
</table>
<p>The details of the benchmark models are as follow:</p>
<ol style="list-style-type: decimal">
<li>Dampen-M3: The implementation of Dampen algorithm as it appears in the original M3 competition.</li>
<li>Best M3 model: In this case, the best model is the Theta method</li>
<li>Dampen-fpp2 : An implementation of the ETS model from fpp2, a popular forecasting package available from CRAN.</li>
</ol>
<p>The LGT&amp;SGT models are inherently Bayesian ETS (Exponential Smoothing) models which are implemented with the aid of the RStan package. As Bayesian models, the LGT&amp;SGT models require specification of prior distributions (with default priors provided) and also take extended running time in some unusual cases. Generally, the running time should be acceptable if the models are run with the default prior and sampling algorithm. In unusual circumstances, some modifications on the prior distributions and Bayesian sampling algorithm might be required to speed up the running time of the models.</p>
<p>As a caveat, the current version of the models only supports time series data with entirely positive data values. Many time series data fall into this category, while for others, simple transformations can be performed to obtain the required positive time-series data. Therefore, the constraint should not be too restrictive for most general applications.</p>
<p>The following sections will briefly describe the mathematical constructions and the rationale for these models.</p>
<hr />
</div>
<div id="lgtlocal-and-global-trend" class="section level2">
<h2>LGT(Local and Global Trend)</h2>
<div id="model-equations" class="section level3">
<h3>Model Equations</h3>
<p>In terms of mathematical notation, the model can be fully represented as follow:</p>
<p><span class="math display">\[y_{t+1} \sim Student (\nu,y_{t+1}, \sigma _{t+1}) \quad (eq.1.1)\]</span></p>
<p><span class="math display">\[\widehat{y}_{t+1}=l_{t}+ \gamma l_{t}^{ \rho }+ \lambda b_{t}  \quad  (eq. 1.2)\]</span></p>
<p><span class="math display">\[l_{t+1}= \alpha y_{t+1}+ \left( 1- \alpha  \right)  \left(  l_{t} \right) \quad (eq. 1.3)\]</span></p>
<p><span class="math display">\[b_{t+1}= \beta  \left( l_{t+1}-l_{t} \right) + \left( 1- \beta  \right) b_{t}  \quad  (eq. 1.4)\]</span></p>
<p><span class="math display">\[\widehat{\sigma}_{t+1}= \sigma l_{t}^{ \tau}+ \xi   \quad  (eq. 1.5)\]</span></p>
</div>
<div id="notations" class="section level3">
<h3>Notations</h3>
<ul>
<li><span class="math inline">\(y_{t}\)</span> :value of the dependent variable of interest at time t</li>
<li><span class="math inline">\(\widehat{y}_{t+1}\)</span> :forecasted value of y at time t+1 given information up to time t</li>
<li><span class="math inline">\(\widehat{\sigma}_{t+1}\)</span> :forecasted deviation at time t+1 given information up to time t</li>
<li><span class="math inline">\(l_{t}\)</span> :level at time t</li>
<li><span class="math inline">\(b_{t}\)</span> :local trend at time t</li>
</ul>
</div>
<div id="parameters" class="section level3">
<h3>Parameters</h3>
<ul>
<li><span class="math inline">\(\nu\)</span> :degrees of freedom of the t-distribution</li>
<li><span class="math inline">\(\gamma\)</span> :coefficient of the global trend</li>
<li><span class="math inline">\(\rho\)</span> :power coefficient of the global trend</li>
<li><span class="math inline">\(\lambda\)</span> :damping coefficient of the local trend</li>
<li><span class="math inline">\(\alpha\)</span> :smoothing parameter for the level term</li>
<li><span class="math inline">\(\beta\)</span> :smoothing parameter for the local trend term</li>
<li><span class="math inline">\(\sigma\)</span> :coefficient of the heteroscedastic standard deviation</li>
<li><span class="math inline">\(\tau\)</span> :power coefficient of the heteroscedastic standard deviation</li>
<li><span class="math inline">\(\xi\)</span> :base or minimum value of the standard deviation</li>
</ul>
</div>
<div id="rationale-for-mathematical-equations" class="section level3">
<h3>Rationale for Mathematical Equations</h3>
<p>The LGT model is devised as an extension to the classical ETS models by incorporating the following additional features:</p>
<ol style="list-style-type: decimal">
<li>Heteroscedastic and non-normal error term</li>
<li>Addition of global trend term</li>
</ol>
<p>The inclusion of these features on each individual equation of the model is discussed below.</p>
<ul>
<li><p><strong>eq. 1.1. Student’s-t Error Distribution</strong></p>
<p>The data value follows Student’s t-distribution around the expected value of the data with a time-varying standard deviation. The Student-t distribution can be seen as a generalisation of the normal distribution to allow for a fat-tailed error distribution.</p></li>
<li><p><strong>eq. 1.5. Heteroscedastic Error</strong></p>
<p>In addition to accounting for a possible fat-tailed error distribution, the error function also allows the variance of the error to change as the level changes. This is achieved by allowing the scale (deviation) parameter of the assumed Student’s t-distribution to vary in proportion to the current level of the time series. This will account for common situations, where the magnitude of the error will increase as the value of the data points increases. Moreover, this relationship does not necessarily have to be linear as the parameter <span class="math inline">\(\tau\)</span> controls the growth of the variance of the error term.</p>
<p>In practice, the value taken by the parameter is often limited between 0 and 1. A value of 0 corresponds to constant variance, i.e. homoscedasticity, whereas a value of 1 approximates the behaviour of the multiplicative error ETS model. The value between 0 and 1 will describe an error function which grows in relation to the increase in data value, but at a slower pace than linear growth.</p></li>
<li><p><strong>eq. 1.2: One-step Ahead Prediction Equation</strong></p>
<p>There are three distinct terms that constitute this Bayesian ETS model: a level term, and a couple of different trends. The first term <span class="math inline">\(l_{t}\)</span> is the level term, while the second term <span class="math inline">\(l_{t}^{ \rho }\)</span> refers to the global trend which increases with the level of the dependent variables <span class="math inline">\(l_{t}\)</span> at a constant rate <span class="math inline">\(\gamma\)</span> . Similar to the heteroscedasticity in eq. 1.5, the change in the value of the dependent variable does not necessarily grow linearly with respect to the level of the variable. This relationship can be tuned in by the use of the exponential parameter <span class="math inline">\(\rho\)</span>.</p>
<p>The interpretation of this global trend is also analogous to the time-varying error term, i.e. the value of $ 0&lt; &lt;1$ indicates a global trend which grows faster than the additive models but slower than the multiplicative model.</p>
<p>The last term of the right-hand side of eq.1.2. refers to the usual local dampen trend in ETS model. However, there is an addition of dampen parameter <span class="math inline">\(\lambda\)</span>, constrained such that <span class="math inline">\(-1&lt;\lambda&lt;1\)</span>, to reduce the strength of the local trend model.</p></li>
<li><p><strong>eq. 1.3: Level Adjustment Equation</strong></p>
<p>This equation is defined according to the classical linear trend ETS model.</p>
<p>The level at time t, <span class="math inline">\(l_{t}\)</span>, is calculated as a weighted average of the current observation <span class="math inline">\(y_{t}\)</span> and the previous level at lag 1, <span class="math inline">\(l_{t-1}\)</span> with smoothing parameter <span class="math inline">\(\alpha\)</span>.</p></li>
<li><p><strong>eq. 1.4: Local Trend Adjustment Equation</strong></p>
<p>Similarly, the evolution of the local trend <span class="math inline">\(b_{t}\)</span> is identically defined to the linear trend method. The local trend at time t <span class="math inline">\(b_{t}\)</span> is obtained as a weighted average of the difference in level terms <span class="math inline">\((l_{t}-l_{t-1})\)</span> and the trend at time t-1 <span class="math inline">\(b_{t-1}\)</span> with the smoothing parameter <span class="math inline">\(\beta\)</span>.</p></li>
</ul>
<hr />
</div>
</div>
<div id="sgt-seasonal-global-trend" class="section level2">
<h2>SGT (Seasonal, Global Trend)</h2>
<p>The SGT model was designed as a seasonal counterpart to the LGT model. Similar to LGT, this model is devised to allow for global trend term and heteroscedastic error.</p>
<div id="model-equations-1" class="section level3">
<h3>Model Equations</h3>
<p><span class="math display">\[y_{t+1} \sim Student \left( \nu,\widehat{y}_{t+1}, \sigma _{t+1} \right)  \quad (eq. 2.1) \]</span></p>
<p><span class="math display">\[\widehat{y}_{t+1}= \left( l_{t}+ \gamma l_{t}^{ \rho } \right)  s_{t+1} \quad (eq. 2.2)\]</span></p>
<p><span class="math display">\[l_{t+1}= \alpha  \frac{y_{t+1}}{s_{t+1}}+ \left( 1- \alpha  \right)  \left( l_{t} \right) \quad (eq. 2.3)\]</span></p>
<p><span class="math display">\[s_{t+m+1}= \zeta  \frac{y_{t+1}}{l_{t+1}}+ \left( 1- \zeta  \right) s_{t+1}  \quad (eq. 2.4)\]</span></p>
<p><span class="math display">\[\widehat{\sigma}_{t+1}= \sigma \widehat{y}_{t+1}^{ \tau}+ \xi \quad (eq. 2.5)\]</span></p>
</div>
<div id="additional-notations" class="section level3">
<h3>Additional Notations</h3>
<ul>
<li><span class="math inline">\(s_{t}\)</span> : seasonality factor at time t</li>
<li><span class="math inline">\(m\)</span> : number of seasons in the data (e.g. 12 for monthly, 4 for quarterly)</li>
</ul>
</div>
<div id="additional-parameters" class="section level3">
<h3>Additional Parameters</h3>
<ul>
<li><span class="math inline">\(\zeta\)</span> : smoothing parameter for the seasonality term</li>
</ul>
</div>
<div id="rationale-for-mathematical-equations-1" class="section level3">
<h3>Rationale for Mathematical Equations</h3>
<p>Most of the components of the model are similar to the non-seasonal LGT model above. A couple of modifications have been applied to this model in comparison to LGT:</p>
<ol style="list-style-type: decimal">
<li>Removal of local dampen trend</li>
<li>Addition of multiplicative seasonality term</li>
</ol>
<p>The mathematical equations have also been adjusted accordingly:</p>
<ul>
<li><p><strong>eq. 2.2.One-step Ahead Prediction Equation</strong></p>
<p>Comparing eq. 2.2 with eq. 1.2, it is apparent that the local trend term <span class="math inline">\(\lambda b_{t}\)</span> has been removed from the SGT model. Consequently, the equation governing the evolution of local trend over time (eq. 2.4) is no longer needed. Based on empirical evidence, the role of the local trend was found to be insignificant for the purpose of forecasting seasonal data in the M3 competition.</p>
<p>Moreover, there is also an addition of a multiplicative seasonality term modelled after the Holt-Winters seasonality term. In this case, the data value is decomposed into a level value and a seasonal value (i.e. <span class="math inline">\(y_{t}=l_{t} s_{t}\)</span>). Thus, it follows that the one-step prediction value of { y_{t+1} } (eq. 2.2) is obtained by multiplying the predicted level term <span class="math inline">\(l_{t}+\gamma l_{t}^{ \rho }\)</span> with the seasonal term <span class="math inline">\(s_{t+1}\)</span>.</p></li>
<li><p><strong>eq. 2.4.Seasonal Factors Adjustment Equation</strong></p>
<p>The evolution of the seasonal component in eq. 2.4. is also based on the standard ETS model, i.e. a weighted average of predicted seasonal level <span class="math inline">\(\left( \frac{y_{t}}{l_{t}} \right)\)</span> and previous seasonal value from the past observations <span class="math inline">\(s_{t}\)</span> .</p></li>
<li><p><strong>eq. 2.3.Level Adjustment Equation</strong></p>
<p>The evolution of the level term in eq. 2.3 is defined analogously to the level term in the LGT model. The level term of time t <span class="math inline">\(\left( l_{t} \right)\)</span> is calculated as a weighted average of the predicted current level value at time t<br />
<span class="math inline">\(\frac{y_{t}}{s_{t}}\)</span> and the previous estimate of the level at time t given information up to t-1, i.e. <span class="math inline">\(l_{t-1}+ \gamma l_{t-1}^{ \rho }\)</span></p></li>
<li><p><strong>eq. 2.5.Heteroscedastic Error</strong></p>
<p>There is also a straightforward modification to the error term in SGT eq. 2.5 due to the introduction of seasonal factors. Compared to eq. 1.5, the error term in SGT is allowed to vary in proportion to <span class="math inline">\(y\)</span> instead of <span class="math inline">\(l_{t}\)</span>. The reason for this is that the error term is likely to become larger during the peak seasons (i.e. seasons with high seasonality coefficient). Hence, it is intuitive to link the dispersion of the error to the predicted value of the dependent variable.</p>
<p>Note that in the case of LGT, the predicted value of y is also a function of the previous level <span class="math inline">\(l_{t-1}\)</span> and thus, the error term can be defined in terms of <span class="math inline">\(l_{t-1}\)</span> instead.</p></li>
</ul>
<hr />
</div>
</div>
<div id="s2gt-double-seasonal-global-trend" class="section level2">
<h2>S2GT (Double Seasonal, Global Trend)</h2>
<p>S2GT is designed as an extension to SGT in time-series data which exhibit two seasonality patterns. The additional second seasonality factor generalises the model to capture a number of seasonalities that exist in the data. A classic example of this type of data are hourly electricity consumption data which are affected by the time of the day as well as the day of the week.</p>
<p>The mathematical modelling is based on the classical Double Seasonal Exponential Smoothing model by Taylor (2003).</p>
<div id="model-equations-2" class="section level3">
<h3>Model Equations</h3>
<p><span class="math display">\[y_{t+1} \sim Student \left( v,y_{t+1}, \sigma _{t+1} \right) \quad (eq. 3.1)\]</span></p>
<p><span class="math display">\[y_{t+1}=\left( l_{t}+ \gamma l_{t}^{ \rho } \right) s_{t+1}w_{t+1} \quad (eq. 3.2)\]</span></p>
<p><span class="math display">\[l_{t}= \alpha  \frac{y_{t}}{s_{t}w_{t}}+ \left( 1- \alpha  \right) \left( l_{t-1} \right)  \quad (eq. 3.3)\]</span></p>
<p><span class="math display">\[s_{t+m}= \zeta  \frac{y_{t}}{l_{t}w_{t}}+ \left( 1- \zeta  \right) s_{t} \quad (eq. 3.4)\]</span></p>
<p><span class="math display">\[w_{t+d}= \delta  \frac{y_{t}}{l_{t}s_{t}}+ \left( 1- \delta  \right) w_{t} \quad (eq. 3.5)\]</span></p>
<p><span class="math display">\[\sigma _{t+1}= \sigma y_{t+1}^{ \tau}+ \varsigma  \quad (eq. 3.6)\]</span></p>
</div>
<div id="additional-notations-1" class="section level3">
<h3>Additional Notations</h3>
<ul>
<li><span class="math inline">\(w_{t}\)</span> :second seasonality factor prevailing at time t</li>
<li><span class="math inline">\(d\)</span> :number of (second) seasons in a complete period (e.g. 12 for monthly, 4 for quarterly)</li>
</ul>
</div>
<div id="additional-parameters-1" class="section level3">
<h3>Additional Parameters</h3>
<ul>
<li><span class="math inline">\(\delta\)</span> : smoothing parameters for the second seasonality factors</li>
</ul>
</div>
<div id="rationale-for-mathematical-equations-2" class="section level3">
<h3>Rationale for Mathematical Equations</h3>
<p>Compared to the SGT model, there is an addition of a second seasonality factor in the S2GT model.</p>
<p>The mathematical equations have been adjusted as follows:</p>
<ul>
<li><p><strong>eq. 3.2. One-step Ahead Prediction Equation</strong></p>
<p>Comparing eq. 3.2 with eq. 2.2, there is an addition of the second seasonality factor in multiplicative form. Thus, both seasonality factors will affect the proportionality between the expected value of the observed data and the level.</p></li>
<li><p><strong>eq. 3.3. Level Adjustment Equation</strong></p>
<p>The evolution of the level term in eq. 3.3 is largely identical to eq. 2.3. The difference is that since the observed value is now seen as a product of the level terms with both seasonality factors, the predicted current level value at time t is calculated as <span class="math inline">\(\frac{y_{t}}{l_{t}s_{t}}\)</span>. The weighted average in the right-hand side of the equation is then adjusted accordingly.</p></li>
<li><p><strong>eq. 3.4. First Seasonal Factors Adjustment Equation</strong></p>
<p>The evolution of the seasonal component in eq. 3.4. is also similar to eq. 2.4. Again, the predicted seasonal level based on the current observation has been changed to <span class="math inline">\(\frac{y_{t}}{l_{t}w_{t}}\)</span> to undo the effect of the other seasonality factor on the observed data value.</p></li>
<li><p><strong>eq. 3.5. Second Seasonal Factors Adjustment Equation</strong></p>
<p>The adjustment equation for the second seasonality term is identical to eq. 3.4. with slight changes in the parameters’ notations and values.</p></li>
</ul>
</div>
</div>
<div id="prior-distributions-for-all-rlgt-models" class="section level2">
<h2>Prior Distributions for all Rlgt models</h2>
<p>The default prior distributions of the parameters are given below:</p>
<ul>
<li><span class="math inline">\(\sigma,\gamma,\varsigma\)</span> : Cauchy distribution with 0 location value and the scale parameter equals to 1/200 of the maximum value of y</li>
<li><span class="math inline">\(b\)</span> : Normal distribution with a mean of 0 and standard deviation of 1/200 of the maximum value of y.</li>
<li><span class="math inline">\(\phi\)</span> : Uniform distribution between -1 and 1</li>
<li><span class="math inline">\(\alpha,\beta,\zeta, \delta\)</span>: Uniform distribution between 0 and 1</li>
<li><span class="math inline">\(s_{t}, w_{t}\)</span> : i.i.d Normal with a mean of 1 and standard deviation of 0.3 (before being normalised)</li>
<li><span class="math inline">\(\rho\)</span> : Uniform distribution between -0.5 and 1.0</li>
<li><span class="math inline">\(v\)</span> : Uniform distribution between 2 and 20</li>
<li><span class="math inline">\(\tau\)</span> : Beta distribution with shape parameters <span class="math inline">\(\alpha=1;\beta =1\)</span></li>
</ul>
<p>Note that some of these prior distributions can be adjusted by the users in the <code>rlgt</code> function.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
